[bandit]
# -----------------------------------------------------------------------------
# Takumi Security Profile
# Focus: RCE (Remote Code Execution), C2 (Command & Control), Data Exfiltration
# -----------------------------------------------------------------------------

# [Target Tests]
# B108: Hardcoded /tmp (Symbolic Link Attack)
# B113: No requests timeout (DoS Hang)
# B301: Pickle (Untrusted Data Deserialization RCE)
# B303: Weak Hashing (MD5)
# B307: Eval, Exec (Dynamic Code Execution)
# B310: urllib.urlopen (SSRF)
# B501: Disable SSL Verification (MITM)
# B506: Unsafe Yaml Load (RCE)
# B602-B609: Subprocess (OS Command Injection)
tests: B108,B113,B301,B303,B307,B310,B501,B506,B602,B603,B604,B605,B606,B607,B608,B609

# [Skips]
# B311: standard_pseudo_random_generators (Excluded because required for image generation seeds, etc.)
# B404: import_subprocess (Allow imports, but check the usage (B60x))
skips: B311,B404

# [Exclusions]
exclude_dirs:
  - tests/
  - venv/
  - .git/
  - __pycache__/
  - .mypy_cache/
  - dist/
  - build/
  # 'ComfyUI Manager' itself is trusted to reduce scan time
  - ComfyUI/custom_nodes/ComfyUI-Manager/
  # Sample code is excluded because it is not executed.
  - */examples/

# [Reporting]
# For communications and RCE, we want to detect even the slightest signs, so we set the level to LOW.
# However, since we're carefully selecting tests, there should be little noise.
severity: LOW
confidence: LOW

# [Output]
output: /tmp/bandit_report.txt
format: txt